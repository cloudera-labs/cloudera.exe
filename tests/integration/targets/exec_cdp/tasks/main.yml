---

- name: Validate the CDP Public Cloud environment configuration
  ansible.builtin.import_role:
    name: cloudera.exe.platform
    tasks_from: validate.yml
  environment: "{{ env_vars }}"
  tags: always

- name: Install the CDP Public Cloud environment
  block:
    - name: Initialize the CDP Public Cloud environment for setup
      ansible.builtin.import_role:
        name: cloudera.exe.platform
        tasks_from: initialize_setup.yml
      environment: "{{ env_vars }}"
    
    - name: Set up the CDP Public Cloud environment
      ansible.builtin.import_role:
        name: cloudera.exe.platform
        tasks_from: setup.yml
      environment: "{{ env_vars }}"
  tags: setup

- name: Teardown the CDP Public Cloud environment
  block:
    - name: Initialize the CDP Public Cloud environment for teardown
      ansible.builtin.import_role:
        name: cloudera.exe.platform
        tasks_from: initialize_teardown.yml
      environment: "{{ env_vars }}"
    
    - name: Tear down the CDP Public Cloud environment
      ansible.builtin.import_role:
        name: cloudera.exe.platform
        tasks_from: teardown.yml
      environment: "{{ env_vars }}"
  tags: teardown